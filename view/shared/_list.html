<?
$permissions = array();
foreach($operation_actions as $oa) $permissions[$oa] = $current_user->allowed($module_name, $oa);
?>
<?if($cms_content):?>
<table class='data_table'>
  <thead>
    <tr>
    <?foreach($scaffold_columns as $col=>$info):?>
    <th class='<?=Inflections::underscore($col)?>'><span><?=Inflections::humanize($col)?></span></th>
    <?endforeach?>
    <th class='operations'></th>
    </tr>
  </thead>
  <tbody>
  <?foreach($cms_content as $i=>$row):?>
  <tr class='row <?=($i%2)?> <?=(($primval && $row->primval == $primval)?"active":"")?> tree-<?=($row instanceOf WaxTreeModel)?> <?=(($row instanceOf WaxTreeModel && ($kids=$row->{$row->children_column}) && $kids->count())?"tree-children":"")?>' id="row_<?=$row->primval?>">
    <?foreach($scaffold_columns as $col=>$info):?>
    <?$value = ((method_exists($row, "humanize"))?$row->humanize($col):$row->$col());?>
    <td class='<?=$col?> <?=Inflections::to_url($value)?>'><?if($permissions['edit']):?><a href="/<?=trim($controller,"/")?>/edit/<?=$row->primval?>/"><?endif?><span><?=$value?></span><?if($permissions['edit']):?></a><?endif?></td>
    <?endforeach?>
    <td class='operations'>
      <?foreach($permissions as $action=>$i):?>   
      <a href="/<?=trim($controller,"/")?>/<?=$action?>/<?=$row->primval?>/" class='button operation operation_<?=$action?>'><?=Inflections::humanize($action)?></a>
      <?endforeach?>
    </td>
  </tr>
  <?endforeach?>
  </tbody>
</table>
<?else:?>
<table class='data_table'>
  <tr><td>No data</td></tr>
</table>
<?endif?>