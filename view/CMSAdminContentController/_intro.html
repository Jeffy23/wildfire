<?
//if this is a draft version of the model then the end point would be the current edit url
if($model->revision()) $endpoint = "/".trim($controller,"/")."/edit/".$model->primval.".json";
//otherwise this is the master, so to start with the endpoint is a revision call
else $endpoint = "/".trim($controller,"/")."/edit/".$model->primval.".json?revision=1";
?>
<a id="auto-save" title="Autosave Enabled"><img src="/images/wildfire/icons/save.png" alt="Autosave Enabled"><span class='enabled' data-save-point="<?=$endpoint?>" data-controller="/<?=trim($controller,"/")?>/">Autosave enabled</span></a>

<?if(($revision = $model->revision()) || ($master = $model->is_live()) || $model->alt_language()):?>
<div class="ui-widget">
  <div class="ui-state-highlight ui-corner-all">
    <?if($revision):?>
    <p><span class="ui-icon ui-icon-info"></span>You are editing a revision of <a href="/<?=trim($controller,"/")?>/edit/<?=$revision?>/">another page</a>.</p>
    <?endif?>
    <?if($master):?>
      <p><span class="ui-icon ui-icon-alert"></span>You are editing the LIVE version.</p>
      <?if(($r=$model->has_revisions()) && $r->count() && ($first_r = $r->first())):?>
      <p><span class="ui-icon ui-icon-circle-zoomout"></span><a href="/<?=trim($controller,"/")?>/edit/<?=$first_r?>">Edit latest revision</a></p>
      <p><span class="ui-icon ui-icon-help"></span><a href="#" class='make_editable'>Edit the live version</a></p>
      <?endif?>
    <?endif?>
    <?if($model->alt_language()):?>
    <p><span class="ui-icon ui-icon-info"></span>You are editing an alternative language (<?=ucwords(CMSApplication::$languages[$model->language]['name'])?>) version of <a href="/<?=trim($controller,"/")?>/edit/<?=$lang?>/">another page</a>.</p>
    <?endif?>
	</div>
</div>
<?endif?>
